# template-gmail-with-spreadsheet
spreadsheetを使ってテンプレートを穴埋めしたメールをgmailで一斉送信する簡単なgasのサンプル

## 使い方
**google spreadsheet** の **スクリプトエディタ** を開いて、
このスクリプトの内容をコピーする。

スクリプトエディタ上で`onOpen`関数を実行すると、
実行の権限を要求される。
実行の権限を与えると、それ以降そのspreadsheetを開いた時に、メニューに **メール** と言う項目が加わる。

これで使えるようになる。

spreadsheetは例えば

| address | name | date |
----|----|----
| alice@example.net | alice | 4月1日|
| bob@example.org | bob | 2月29日 |

のようにする。

シートの上端はヘッダーであり、テンプレートで置き換えられる変数名を指定する。
ただし、左の端はメールアドレスで固定である。

2行目からは、実際に置き換える文字列を入力する。

メニューのメールボタンを押すと、 **一斉送信** と **テスト送信** という二つのボタンが見える。

テスト送信を押すと、件名と送り先とテンプレートファイル名の入力を求められる。

テンプレートファイル名はとりあえず`sample.html`が用意されているので、`sample`と入力する。
（これに`html`と言う拡張子がついているのは、
スクリプトエディタで作成できるファイルが`gas`か`html`であったためで、
実際には`html`ではない）

すると、1行目のデータを使って、そのspreadsheetの持ち主のgoogleアカウントのgmailから、
入力した件名を持ち、
templateファイルの変数部分を1行目のデータに置き換えた文章、
今回の場合は`sample.html`の`name`部分を **alice** に、`date`部分を **4月1日** に置換した文章、
すなわち「こんにちは、アリスさん！　4月1日に会いましょう！」という文章を本文に持つメールが
入力したメールアドレスに向けて送られる。

一斉送信の側のボタンを押すと、件名とテンプレートファイル名を入力を求められる。
この場合は送信ボタンを押すと、1行目以降の全ての宛先に対して本当に一斉送信される。

`sample.html`を参考に、テンプレートファイルを作成し、spreadsheetに必要なheaderと実データを記載することで、
カスタマイズが可能である。
文法はただ単に`<?= 変数名 ?>`のように変数名を`<?= ?>`で括るだけである。

なお大量のメールを送った場合に、大丈夫かどうかは試験していない。

